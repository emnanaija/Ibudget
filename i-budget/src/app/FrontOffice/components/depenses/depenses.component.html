<div class="dashboard-container">
  <!-- Fond animé style dashboard -->
  <div class="animated-background">
    <div class="liquid-bg">
      <div class="liquid-blob blob1"></div>
      <div class="liquid-blob blob2"></div>
      <div class="liquid-blob blob3"></div>
    </div>
    <div class="particles-container"></div>
    <div class="coin-container">
      <div class="coin gsap-coin1"></div>
      <div class="coin gsap-coin2"></div>
      <div class="coin gsap-coin3"></div>
      <div class="coin gsap-coin4"></div>
      <div class="coin gsap-coin5"></div>
      <div class="coin gsap-coin6"></div>
    </div>
  </div>

  <!-- Sidebar toggle -->
  <button class="sidebar-toggle" [class.collapsed]="isSidebarCollapsed" (click)="toggleSidebar()">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </button>

  <!-- Sidebar -->
  <app-sidebar [isCollapsed]="isSidebarCollapsed" (toggleSidebar)="toggleSidebar()"></app-sidebar>

  <!-- Main content -->
  <div class="main-content" [class.sidebar-collapsed]="isSidebarCollapsed">
    <app-header [isSidebarCollapsed]="isSidebarCollapsed"></app-header>

    <div class="content-area">
      <div class="depenses-container">
        <!-- Indicateur de chargement -->
        <div *ngIf="isLoading()" class="loading-spinner">
          <span>Chargement des dépenses...</span>
        </div>

        <!-- Message d'erreur -->
        <div *ngIf="errorMessage()" class="error-message">
          {{ errorMessage() }}
        </div>

        <!-- Liste des dépenses -->
        <ng-container *ngIf="depenses$ | async as depenses">
          <div *ngIf="depenses.length === 0" class="no-data">
            Aucune dépense trouvée.
          </div>

          <div class="depenses-list">
            <div *ngFor="let depense of depenses" class="depense-item">
              <div class="depense-detail">
                <span class="label">Montant:</span>
                <span>{{ depense.montant | currency:'TND' }}</span>
              </div>
              <div class="depense-detail">
                <span class="label">Date:</span>
                <span>{{ depense.date | date:'mediumDate' }}</span>
              </div>
              <div class="depense-detail">
                <span class="label">État:</span>
                <div class="etat-container">
                  <span>{{ depense.etat }}</span>
                  <i class="fas fa-edit edit-icon" (click)="modifierEtat(depense)"></i>
                </div>
              </div>
              <div class="depense-detail">
                <span class="label">Catégorie:</span>
                <span *ngIf="depense.category && isCategoryObject(depense.category)">
                  {{ depense.category.nom }}
                </span>
                <span *ngIf="depense.category && !isCategoryObject(depense.category)">
                  ID: {{ depense.category }}
                </span>
              </div>
              <div class="depense-detail">
                <span class="label">Wallet:</span>
                <span>{{ depense.wallet?.solde | currency:'TND' }} ({{ depense.wallet?.statut }})</span>
              </div>
              <div class="depense-detail" *ngIf="depense.photoUrl">
                <span class="label">Photo:</span>
                <img *ngIf="depense.photoUrl" [src]="'http://localhost:8090' + depense.photoUrl"
                  alt="Image de la dépense" class="depense-photo" />
              </div>
            </div>
          </div>
        </ng-container>
      </div>
    </div>
  </div>
</div>

<!-- Optionnel : Canvas 3D si tu veux l’inclure -->
<div #card3d class="card-3d-container"></div>

<div class="dashboard-container">
  <!-- Fond animé style dashboard -->


  <h2 class="list-title">Liste des dépenses</h2>


  <!-- Main content -->
  <div class="main-content">

    <div class="content-area">
      <div class="depenses-container">
        <!-- Indicateur de chargement -->
        <div *ngIf="isLoading()" class="loading-spinner">
          <span>Chargement des dépenses...</span>
        </div>

        <!-- Message d'erreur -->
        <div *ngIf="errorMessage()" class="error-message">
          {{ errorMessage() }}
        </div>

        <!-- Liste des dépenses -->
        <ng-container *ngIf="depenses$ | async as depenses">
          <div *ngIf="depenses.length === 0" class="no-data">
            Aucune dépense trouvée.
          </div>

          <div class="depenses-list">
            <div *ngFor="let depense of depenses" class="depense-item">
              <div class="depense-detail">
                <span class="label">Montant:</span>
                <span>{{ depense.montant | currency:'TND' }}</span>
              </div>
              <div class="depense-detail">
                <span class="label">Date:</span>
                <span>{{ depense.date | date:'mediumDate' }}</span>
              </div>
              <div class="depense-detail">
                <span class="label">État:</span>
                <div class="etat-container">
                  <span>{{ depense.etat }}</span>
                  <i class="fas fa-edit edit-icon" (click)="modifierEtat(depense)"></i>
                </div>
              </div>
              <div class="depense-detail">
                <span class="label">Catégorie:</span>
                <span *ngIf="depense.category && isCategoryObject(depense.category)">
                  {{ depense.category.nom }}
                </span>
                <span *ngIf="depense.category && !isCategoryObject(depense.category)">
                  ID: {{ depense.category }}
                </span>
              </div>
              <div class="depense-detail">
                <span class="label">Wallet:</span>
                <span>{{ depense.wallet.solde | currency:'TND' }} ({{ depense.wallet.statut }})</span>
              </div>
              <!-- Affichage de la photo miniature -->
              <div class="depense-detail" *ngIf="depense.photoUrl">
                <span class="label">Photo:</span>
                <div class="photo-wrapper">
                  <img
                    *ngIf="depense.photoUrl"
                    [src]="'http://localhost:8090' + depense.photoUrl"
                    alt="Image de la dépense"
                    class="depense-photo"
                    (click)="toggleImage(depense.photoUrl)"
                  />
                </div>
              </div>
              
              <!-- Modale pour l’image agrandie -->
              <div *ngIf="imageSelectionnee" class="photo-modal" (click)="toggleImage(imageSelectionnee)">
                <div class="photo-modal-box">
                  <button class="close-btn" (click)="toggleImage(imageSelectionnee)">X</button>
                  <img [src]="'http://localhost:8090' + imageSelectionnee" alt="Photo en grand" />
                </div>
              </div>
              
              

            </div>
          </div>
        </ng-container>
      </div>
    </div>
  </div>
</div>

<!-- Optionnel : Canvas 3D si tu veux l’inclure -->
<div #card3d class="card-3d-container"></div>
